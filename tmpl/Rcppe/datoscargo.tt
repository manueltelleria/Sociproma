<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>[% titulo %]</title>
<!-- hojas de estilo generales -->
[% INCLUDE estilosgenerales.tt %]
[%INCLUDE jsgenerales.tt %]

<!-- archivos de javascript para Prototype -->
<script type="text/javascript" src="[%ruta_estatica%]/js/prototype/prototype.js"></script>
<script type="text/javascript" src="[%ruta_estatica%]/js/prototype/controls.js"></script>
<script type="text/javascript" src="[%ruta_estatica%]/js/prototype/effects.js"></script>
<script type="text/javascript" src="[%ruta_estatica%]/js/prototype/dragdrop.js"></script>

<!-- hoja de estilo del calendario -->
<link rel="stylesheet" type="text/css" media="all" href="[% ruta_estatica %]/js/jscalendar/calendar-win2k-cold-2.css" title="Calendario" />
<script type="text/javascript" src="[% ruta_estatica %]/js/jscalendar/calendar.js"></script>
<script type="text/javascript" src="[% ruta_estatica %]/js/jscalendar/lang/calendar-es.js"></script>
<script type="text/javascript" src="[% ruta_estatica %]/js/jscalendar/calendar-setup.js"></script>

<script type="text/javascript" src="[%ruta_estatica%]/js/seleccionarItemList.js"></script>

<script language="JavaScript">

function buscarOrgAdj(){
  var url = '[% ruta_buscar %]';
  var forma = document.datoscargo;
  var id_empresa = forma.tpempresa.value;

  forma.bvalidaorg.value = 0;
  if (id_empresa){
    var pars = "id_empresa="+id_empresa;
    var myAjax = new Ajax.Request( url, { method: 'post', parameters: pars , onComplete: mostrar });
  }
}

function mostrar(originalRequest){
  var respuesta = originalRequest.responseText;
  var forma = document.datoscargo;

  limpiarListas('tporgadjunto');

  if ( respuesta != 'undef' ){
    if ( respuesta != 'error' ){
      forma.bvalidaorg.value = 1;
      var primerarreglo = respuesta.split("|");
      for(i=0;i<primerarreglo.length;i++){
        var elemento  = primerarreglo[i].split(":");
        agregarOpcionLista(forma.tporgadjunto,new Option(elemento[1],elemento[0]));
      }
    }
  }

}

// FunciÃ³n limpiarListas: MÃ©todo encargado de limpiar el contenido de una lista desplegable.
function limpiarListas(nombreLista) {
  var forma = document.datoscargo;
  vaciarLista(eval('forma.'+nombreLista));
}

function validate_datoscargo (form) {
  var alertstr = '';
  var invalid  = 0;
  var invalid_fields = new Array();

// tpempresa: select list, always assume it's multiple to get all values
  var tpempresa = null;
  var selected_tpempresa = 0;
  for (var loop = 0; loop < form.elements['tpempresa'].options.length; loop++) {
    if (form.elements['tpempresa'].options[loop].selected) {
      tpempresa = form.elements['tpempresa'].options[loop].value;
      selected_tpempresa++;
      if (tpempresa == null || tpempresa == "" || tpempresa === "") {
        alertstr += '- Seleccione una opción para el campo "Nombre del Instituto o Empresa"\n';
        invalid++;
        invalid_fields.push('tpempresa');
      }
    } // if
  } // for tpempresa

// tpcargo: select list, always assume it's multiple to get all values
  var tpcargo = null;
  var selected_tpcargo = 0;
  for (var loop = 0; loop < form.elements['tpcargo'].options.length; loop++) {
    if (form.elements['tpcargo'].options[loop].selected) {
      tpcargo = form.elements['tpcargo'].options[loop].value;
      selected_tpcargo++;
      if (tpcargo == null || tpcargo == "" || tpcargo === "") {
        alertstr += '- Seleccione una opción para el campo "Cargo"\n';
        invalid++;
        invalid_fields.push('tpcargo');
      }
    } // if
  } // for tpcargo


//Se valida que la fecha de cese sea mayor a la fecha de posesion

  var dposesion = form.elements['dposesion'].value;
  var dcese     = form.elements['dcese'].value;

  if ( dposesion && dcese ){
    var Arrposesion = dposesion.split("/");
    var Arrcese     = dcese.split("/");
    var dvalposesion = Arrposesion[2]+Arrposesion[1]+Arrposesion[0];
    var dvalcese     = Arrcese[2]+Arrcese[1]+Arrcese[0];

    if ( dvalcese <= dvalposesion ){
      alertstr += '- La fecha de cese de funciones no puede ser menor a la fecha de posesión\n';
      invalid++;
      invalid_fields.push('dcese');
    }
  }

  if (invalid > 0 || alertstr != '') {
    if (! invalid) invalid = 'The following';   // catch for programmer error
    alert(''+invalid+' error(es) fueron encontrados al aceptar la información:'+'\n\n'
    +alertstr+'\n'+'- Por favor corrija los campos y trate de nuevo');
    return false;
  }

  return true;  // all checked ok
}

</script>

[%formbuilder.jshead%]

[%INCLUDE jscargarmenu.tt%]

</head>
<body onload="cargarMenu()">

[%INCLUDE encabezado.tt %]
[%formbuilder.start%]
[%formbuilder.statetags%]
[%formbuilder.keepextras%]
<fieldset>
<legend>Datos Cargo</legend>
<table border="0" align="center" cellspacing="3" cellpadding="5" width="60%">
  <tr>
    <td colspan="2" class="titulodonforojo" align="center"><b>Datos del Organismo Adscrito</b></td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.tpempresa.label %]:</td>
    <td>[% formbuilder.field.tpempresa.field %]</td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.tporgadjunto.label %]:</td>
    <td>[% formbuilder.field.tporgadjunto.field %]</td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.tpcargo.label %]:</td>
    <td>[% formbuilder.field.tpcargo.field %]</td>
  </tr>
  <tr>
    <td colspan="2" align="center" class="titulodonforojo"><b>Datos Designaci&oacute;n del Cargo</b></td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.nrogaceta.label %]:</td>
    <td>[% formbuilder.field.nrogaceta.field %]</td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.nroresolucion.label %]:</td>
    <td>[% formbuilder.field.nroresolucion.field %]</td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.nrodecreto.label %]:</td>
    <td>[% formbuilder.field.nrodecreto.field %]</td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.dposesion.label %]:</td>
    <td>[% formbuilder.field.dposesion.field %]&nbsp;<img src="[% ruta_estatica %]/imagenes/calendario.jpg" title="Desplegar Calendario" width="25" height="18" id="t_dposesion" style="cursor: pointer; border: 0px solid #0F305A;" onmouseover="this.style.background='#0F305A';" onMouseOut="this.style.background=''"/>
      <script type="text/javascript">
        Calendar.setup({
                         inputField     :    "dposesion",     // id of the input field
                         ifFormat       :    "%d/%m/%Y",      // format of the input field
                         button         :    "t_dposesion",  // trigger for the calendar (button ID)
                         align          :    "Tl",           // alignment (defaults to "Bl")
                         singleClick    :    true
                      });
      </script>
    </td>
  </tr>
  <tr>
    <td class="fondoetiqueta">[% formbuilder.field.dcese.label %]:</td>
    <td>[% formbuilder.field.dcese.field %]&nbsp;<img src="[% ruta_estatica %]/imagenes/calendario.jpg" title="Desplegar Calendario" width="25" height="18" id="t_dcese" style="cursor: pointer; border: 0px solid #0F305A;" onmouseover="this.style.background='#0F305A';" onMouseOut="this.style.background=''"/>
      <script type="text/javascript">
        Calendar.setup({
                         inputField     :    "dcese",     // id of the input field
                         ifFormat       :    "%d/%m/%Y",  // format of the input field
                         button         :    "t_dcese",   // trigger for the calendar (button ID)
                         align          :    "Tl",        // alignment (defaults to "Bl")
                         singleClick    :    true
                      });
      </script>
    </td>
  </tr>
</table>
<table border="0" align="center" cellspacing="3" cellpadding="5" width="60%">
  <tr>
    <td align="right">[% formbuilder.field.btnvolver.field %]</td>
    <td align="left">[% formbuilder.submit %]</td>
  </tr>
</table>
</fieldset>
<br/>
[% formbuilder.field.id_persona.field %]
[% formbuilder.field.bvalidaorg.field %]
[% formbuilder.field.id_cargo.field %]
[% formbuilder.end %]
</body>
</html>
