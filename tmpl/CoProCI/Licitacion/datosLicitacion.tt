<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>[% titulo %]</title>
<!-- hojas de estilo generales -->
[% INCLUDE estilosgenerales.tt %]

<!-- hoja de estilo del calendario -->
<link rel="stylesheet" type="text/css" media="all" href="[% ruta_estatica %]/js/jscalendar/calendar-win2k-cold-2.css" title="Calendario" />
<script type="text/javascript" src="[%ruta_estatica%]/js/jscalendar/calendar.js"></script>
<script type="text/javascript" src="[%ruta_estatica%]/js/jscalendar/lang/calendar-es.js"></script>
<script type="text/javascript" src="[%ruta_estatica%]/js/jscalendar/calendar-setup.js"></script>

<!-- archivos de javascript generales (cargar en todas las páginas) -->
[% INCLUDE jsgenerales.tt %]

<script type="text/javascript">

function validar( form ){
  if (validate_datosLicitacion(form)){

    var alertstr='';
    var invalid=0;

    //validar el monto maximo para la licitación
    var nmtocontrato  = form.elements['nmtocontrato'].value;
    var nmtototaldisp = "[% datos.nmtototaldisp %]";

    var monto = nmtocontrato.replace(/\./g,'');
    monto = monto.replace(',','.');
    monto = parseFloat(monto);

    if ( monto > nmtototaldisp ) {
      alertstr += "- El monto máximo disponible para el contrato comercial de la licitación es de "+ formatearMoneda(nmtototaldisp) +" $\n";
      invalid++;
    }

    //validar que las fechas de solicitud y pago del desembolso sean mayores a la de suscrpcion del contrato
    var dcontratoproy   = "[% datos.dcontrato %]";
    var dinicio         = form.elements['dinicio'].value.split('/');
    var dcontrato       = form.elements['dcontrato'].value.split('/');
    var dvenc           = form.elements['dvenc'].value.split('/');
    dcontratoproy = dcontratoproy.replace(/-/g,'');
    dinicio   = dinicio[2]+dinicio[1]+dinicio[0];
    dcontrato = dcontrato[2]+dcontrato[1]+dcontrato[0];
    dvenc     = dvenc[2]+dvenc[1]+dvenc[0];

    if ( dinicio < dcontratoproy ) {
      alertstr += "- La fecha de inicio de la publicación debe ser mayor o igual que la de suscripción del contrato del proyecto\n";
      invalid++;
    }

    if ( dcontrato < dcontratoproy ) {
      alertstr += "- La fecha de suscripción del contrato de la licitación debe ser mayor o igual que la de suscripción del contrato del proyecto\n";
      invalid++;
    }

    if ( dvenc < dcontratoproy ) {
      alertstr += "- La fecha de culminación del plazo de ejecución debe ser mayor o igual que la de suscripción del contrato del proyecto\n";
      invalid++;
    }

    if (invalid > 0 || alertstr != '') {
      alert(''+invalid+' error(es) fueron encontrados al aceptar la información:'+'\n\n'
              +alertstr+'\n'+'- Por favor corrija los campos y trate de nuevo');
      return false;
    }

    return true;

  }else{ return false; }
}

</script>

<!--
En la plantilla siguiente se incluye el javascript para cargar el menu,
asociado al evento onload de la página. Si se quiere personalizar dicho evento,
debe escribirse la nueva función de javascript requerida y, dentro, invocar a
la función cargarMenu() existente, cambiando la respectiva etiqueta <body>.
-->
[% INCLUDE jscargarmenu.tt %]
[% formbuilder.jshead %]
</head>
<body onload="cargarMenu()">
[% INCLUDE encabezado.tt %]
<fieldset>
<legend>Registrar Licitaciones</legend>

[% formbuilder.start %]
[% formbuilder.statetags %]
[% formbuilder.keepextras %]

<table align="center" cellpadding="2" width="60%" border="0">
<tr>
  <td align="center" colspan="2" class="titulodonforojo">Datos de la Licitaci&oacute;n</td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.id_proyectos.label %]</td>
  <td width="60%" align="left"><b>[% datos.id_proyectos %]</b></td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.id.label %]</td>
  <td width="60%" align="left"><b>(Autogenerado)</b></td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.id_tpadquisicion.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.id_tpadquisicion.field %]</td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.sobjeto.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.sobjeto.field %]</td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.dinicio.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.dinicio.field %]&nbsp;<img src="[% ruta_estatica %]/imagenes/calendario.jpg" title="Desplegar Calendario" width="25" height="18" id="t_dinicio" style="cursor: pointer; border: 0px solid #0F305A;" onmouseover="this.style.background='#0F305A';" onMouseOut="this.style.background=''"/>
           <script type="text/javascript">
           Calendar.setup({
                    inputField     :    "dinicio",     // id of the input field
                    ifFormat       :    "%d/%m/%Y",      // format of the input field
                    button         :    "t_dinicio",  // trigger for the calendar (button ID)
                    align          :    "Tl",           // alignment (defaults to "Bl")
                    singleClick    :    true
                        });
           </script></td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.dcontrato.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.dcontrato.field %]&nbsp;<img src="[% ruta_estatica %]/imagenes/calendario.jpg" title="Desplegar Calendario" width="25" height="18" id="t_dcontrato" style="cursor: pointer; border: 0px solid #0F305A;" onmouseover="this.style.background='#0F305A';" onMouseOut="this.style.background=''"/>
           <script type="text/javascript">
           Calendar.setup({
                    inputField     :    "dcontrato",     // id of the input field
                    ifFormat       :    "%d/%m/%Y",      // format of the input field
                    button         :    "t_dcontrato",  // trigger for the calendar (button ID)
                    align          :    "Tl",           // alignment (defaults to "Bl")
                    singleClick    :    true
                        });
           </script></td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.dvenc.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.dvenc.field %]&nbsp;<img src="[% ruta_estatica %]/imagenes/calendario.jpg" title="Desplegar Calendario" width="25" height="18" id="t_dvenc" style="cursor: pointer; border: 0px solid #0F305A;" onmouseover="this.style.background='#0F305A';" onMouseOut="this.style.background=''"/>
           <script type="text/javascript">
           Calendar.setup({
                    inputField     :    "dvenc",     // id of the input field
                    ifFormat       :    "%d/%m/%Y",      // format of the input field
                    button         :    "t_dvenc",  // trigger for the calendar (button ID)
                    align          :    "Tl",           // alignment (defaults to "Bl")
                    singleClick    :    true
                        });
           </script></td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.nmtooferta.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.nmtooferta.field %]</td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.nmtocontrato.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.nmtocontrato.field %]</td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.splazoejec.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.splazoejec.field %]</td>
</tr>
<tr>
  <td width="40%" align="left" class="fondoetiqueta5">[% formbuilder.field.sobservaciones.label %]</td>
  <td width="60%" align="left">[% formbuilder.field.sobservaciones.field %]</td>
</tr>
  <tr>
    <td colspan="2" align="left" ><font color="#0F305A" size="0" >Nota: Todos los campos son obligatorios.</font></td>
  </tr>
</table>
&nbsp;
<table align="center" width="60%">
  <tr>
    <td align="center">[% formbuilder.field.btnvolver.field %]&nbsp;[% formbuilder.submit %]</td>
  </tr>
</table>

[% formbuilder.end %]
</fieldset>
</body>
</html>